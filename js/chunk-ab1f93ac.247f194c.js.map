{"version":3,"sources":["webpack:///./src/views/store/index.vue?0aaf","webpack:///./src/util/aws.config.js","webpack:///./src/views/store/index.vue?976f","webpack:///./src/views/store/index.vue?a51b","webpack:///src/views/store/index.vue","webpack:///./src/views/store/index.vue","webpack:///./src/util/loading.js"],"names":["AWS","config","update","region","credentials","CognitoIdentityCredentials","IdentityPoolId","s3","S3","apiVersion","params","Bucket","addPhoto","files","startLoading","file","isJPG","type","isLt2M","size","Vue","prototype","$message","showClose","message","i18n","t","Promise","reject","msg","prototyoe","index","name","lastIndexOf","suffix","slice","length","photoKey","uid","upload","Key","Body","ACL","partSize","queueSize","promise","addIndex","console","log","then","data","err","created","this","businessData","do_business_end_minute","minutesToTime","do_business_start_minute","announcement_picture","logo","is_open","address","avatarLoading","announcementLoading","isLoading","computed","formRules","methods","timeToMinutes","hour","getShopInfo","shop_id","shopId","getShopBasicInfo","obj","beforeAvatarUpload","error","$t","uploadFile","uploadAnnouncementPic","handleSave","$refs","form","validate","valid","component","_vm","_h","$createElement","_c","_self","staticClass","ref","attrs","model","value","callback","$$v","$set","expression","staticStyle","start","step","end","directives","rawName","slot","_v","_s","_e","on","loadingInstance","targetdq","options","text","background","target","document","querySelector","customClass","Loading","service","endLoading","close"],"mappings":"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","file":"js/chunk-ab1f93ac.247f194c.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/sass-resources-loader/lib/loader.js??ref--8-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=faeae460&lang=scss&scoped=true&\"","import AWS from 'aws-sdk';\nimport Vue from 'vue';\nimport i18n from '@/lang/index.js';\nimport { startLoading } from '@/util/loading.js';\nvar albumBucketName = 'test.znox.top.images';\nvar bucketRegion = 'ap-southeast-2';\nvar IdentityPoolId = 'ap-southeast-2:3690eca5-99fb-4e84-8cf4-74ec0ac8162c';\n\nAWS.config.update({\n  region: bucketRegion,\n  credentials: new AWS.CognitoIdentityCredentials({\n    IdentityPoolId: IdentityPoolId,\n  }),\n});\n\nvar s3 = new AWS.S3({\n  apiVersion: '2006-03-01',\n  params: {\n    Bucket: albumBucketName,\n  },\n});\n\n// 添加照片\nexport function addPhoto(files) {\n  startLoading('.avatar_loading');\n  const file = files.file;\n  const isJPG = file.type === 'image/jpeg' || file.type === 'image/png';\n  const isLt2M = file.size / 1024 / 1024 < 2;\n\n  if (!isJPG) {\n    Vue.prototype.$message({\n      showClose: true,\n      message: i18n.t('error.picTypeErr'),\n      type: 'error',\n    });\n    return Promise.reject({ msg: 'uploaderr' });\n  }\n  if (!isLt2M) {\n    Vue.prototyoe.$message({\n      showClose: true,\n      message: i18n.t('error.picMaxErr'),\n      type: 'error',\n    });\n    return Promise.reject({ msg: 'uploaderr' });\n  }\n  let index = file.name.lastIndexOf('.');\n  let suffix = file.name.slice(index, file.name.length);\n  let photoKey = 'static/images/' + file.uid + suffix;\n  let options = {\n    partSize: 10 * 1024 * 1024,\n    queueSize: 1,\n  };\n  return s3\n    .upload(\n      {\n        Bucket: albumBucketName,\n        Key: photoKey,\n        Body: file,\n        ACL: 'public-read',\n      },\n      options\n    )\n    .promise();\n}\n\nexport function addIndex(files) {\n  const file = files.file;\n  console.log(file);\n  return s3\n    .upload({\n      Bucket: albumBucketName,\n      Key: 'index.html',\n      Body: file,\n      ACL: 'public-read',\n    })\n    .promise()\n    .then(\n      (data) => {\n        console.log('success', data);\n      },\n      (err) => {\n        console.log('failed', err);\n      }\n    );\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-card',{staticClass:\"store-card\"},[_c('el-form',{ref:\"form\",staticClass:\"store-form\",attrs:{\"label-position\":\"left\",\"label-width\":\"130px\",\"model\":_vm.businessData,\"rules\":_vm.formRules}},[_c('el-form-item',{attrs:{\"label\":_vm.$t('store.currentState'),\"prop\":\"is_open\"}},[_c('el-select',{model:{value:(_vm.businessData.is_open),callback:function ($$v) {_vm.$set(_vm.businessData, \"is_open\", $$v)},expression:\"businessData.is_open\"}},[_c('el-option',{attrs:{\"label\":_vm.$t('store.business'),\"value\":1}}),_c('el-option',{attrs:{\"label\":_vm.$t('store.suspend'),\"value\":0}})],1)],1),_c('el-form-item',{attrs:{\"label\":_vm.$t('store.name'),\"prop\":\"name\"}},[_c('el-input',{staticClass:\"storeName\",staticStyle:{\"width\":\"50%\"},model:{value:(_vm.businessData.name),callback:function ($$v) {_vm.$set(_vm.businessData, \"name\", $$v)},expression:\"businessData.name\"}})],1),_c('el-form-item',{staticClass:\"location\",attrs:{\"label\":_vm.$t('store.location'),\"prop\":\"address\"}},[_c('el-input',{staticStyle:{\"width\":\"50%\"},model:{value:(_vm.businessData.address),callback:function ($$v) {_vm.$set(_vm.businessData, \"address\", $$v)},expression:\"businessData.address\"}})],1),_c('el-form-item',{attrs:{\"label\":_vm.$t('store.openingTime'),\"prop\":\"do_business_start_minute\"}},[_c('el-time-select',{staticStyle:{\"width\":\"100%\"},attrs:{\"placeholder\":_vm.$t('store.openTimePlaceholder'),\"picker-options\":{\n          start: '06:00',\n          step: '01:00',\n          end: '24:00',\n        }},model:{value:(_vm.businessData.do_business_start_minute),callback:function ($$v) {_vm.$set(_vm.businessData, \"do_business_start_minute\", $$v)},expression:\"businessData.do_business_start_minute\"}})],1),_c('el-form-item',{attrs:{\"label\":_vm.$t('store.closingTime'),\"prop\":\"do_business_end_minute\"}},[_c('el-time-select',{staticStyle:{\"width\":\"100%\"},attrs:{\"placeholder\":_vm.$t('store.closeTimePlaceHolder'),\"picker-options\":{\n          start: '06:00',\n          step: '01:00',\n          end: '24:00',\n        }},model:{value:(_vm.businessData.do_business_end_minute),callback:function ($$v) {_vm.$set(_vm.businessData, \"do_business_end_minute\", $$v)},expression:\"businessData.do_business_end_minute\"}})],1),_c('el-form-item',{staticClass:\"map\",attrs:{\"label\":this.$t('store.announcementMap'),\"prop\":\"announcement_picture\"}},[_c('div',{staticClass:\"announcement_list\"},[_c('el-upload',{staticClass:\"announcement-uploader\",attrs:{\"action\":\"\",\"show-file-list\":false,\"http-request\":_vm.uploadAnnouncementPic}},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.announcementLoading),expression:\"announcementLoading\"}],staticClass:\"announcment_loading\"}),_c('div',{staticClass:\"announcement_pic\"},[_c('el-image',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.businessData.announcement_picture),expression:\"businessData.announcement_picture\"}],staticStyle:{\"width\":\"100%\"},attrs:{\"src\":_vm.businessData.announcement_picture}}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.businessData.announcement_picture),expression:\"!businessData.announcement_picture\"}]},[_c('i',{staticClass:\"el-icon-plus announcement-uploader-icon\"}),_c('div',{staticClass:\"el-upload__tip\",attrs:{\"slot\":\"tip\"},slot:\"tip\"},[_vm._v(\" \"+_vm._s(_vm.$t(\"public.picInfo\"))+\" \")])])],1)])],1)]),_c('el-form-item',{staticClass:\"avatar-uploader\",attrs:{\"prop\":\"logo\"}},[_c('el-upload',{attrs:{\"action\":\"\",\"show-file-list\":false,\"http-request\":_vm.uploadFile,\"before-upload\":_vm.beforeAvatarUpload}},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.avatarLoading),expression:\"avatarLoading\"}],staticClass:\"avatar_loading\"}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.avatarLoading),expression:\"!avatarLoading\"}]},[(_vm.businessData.logo)?_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm.businessData.logo}}):_vm._e(),_c('i',{staticClass:\"el-icon-plus avatar-uploader-icon\"}),_c('div',{staticClass:\"el-upload__tip\",attrs:{\"slot\":\"tip\"},slot:\"tip\"},[_vm._v(\" \"+_vm._s(_vm.$t(\"public.picInfo\"))+\" \")])])])],1),_c('el-form-item',{staticClass:\"lastItem\",staticStyle:{\"width\":\"100%\"}},[_c('el-button',{staticClass:\"saveBtn\",attrs:{\"type\":\"primary\",\"loading\":_vm.isLoading},on:{\"click\":_vm.handleSave}},[_vm._v(_vm._s(_vm.$t(\"btn.save\")))])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","<template>\n  <el-card class=\"store-card\">\n    <el-form\n      ref=\"form\"\n      class=\"store-form\"\n      label-position=\"left\"\n      label-width=\"130px\"\n      :model=\"businessData\"\n      :rules=\"formRules\"\n    >\n      <el-form-item :label=\"$t('store.currentState')\" prop=\"is_open\">\n        <el-select v-model=\"businessData.is_open\">\n          <el-option :label=\"$t('store.business')\" :value=\"1\"></el-option>\n          <el-option :label=\"$t('store.suspend')\" :value=\"0\"></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item :label=\"$t('store.name')\" prop=\"name\">\n        <el-input\n          v-model=\"businessData.name\"\n          class=\"storeName\"\n          style=\"width: 50%\"\n        >\n        </el-input>\n      </el-form-item>\n      <el-form-item\n        class=\"location\"\n        :label=\"$t('store.location')\"\n        prop=\"address\"\n      >\n        <el-input v-model=\"businessData.address\" style=\"width: 50%\"> </el-input>\n      </el-form-item>\n      <el-form-item\n        :label=\"$t('store.openingTime')\"\n        prop=\"do_business_start_minute\"\n      >\n        <el-time-select\n          :placeholder=\"$t('store.openTimePlaceholder')\"\n          v-model=\"businessData.do_business_start_minute\"\n          :picker-options=\"{\n            start: '06:00',\n            step: '01:00',\n            end: '24:00',\n          }\"\n          style=\"width: 100%\"\n        >\n        </el-time-select>\n      </el-form-item>\n      <el-form-item\n        :label=\"$t('store.closingTime')\"\n        prop=\"do_business_end_minute\"\n      >\n        <el-time-select\n          :placeholder=\"$t('store.closeTimePlaceHolder')\"\n          v-model=\"businessData.do_business_end_minute\"\n          :picker-options=\"{\n            start: '06:00',\n            step: '01:00',\n            end: '24:00',\n          }\"\n          style=\"width: 100%\"\n        >\n        </el-time-select>\n      </el-form-item>\n\n      <el-form-item\n        :label=\"this.$t('store.announcementMap')\"\n        class=\"map\"\n        prop=\"announcement_picture\"\n      >\n        <div class=\"announcement_list\">\n          <el-upload\n            class=\"announcement-uploader\"\n            action=\"\"\n            :show-file-list=\"false\"\n            :http-request=\"uploadAnnouncementPic\"\n          >\n            <div class=\"announcment_loading\" v-show=\"announcementLoading\"></div>\n            <div class=\"announcement_pic\">\n              <el-image\n                style=\"width: 100%\"\n                v-show=\"businessData.announcement_picture\"\n                :src=\"businessData.announcement_picture\"\n              ></el-image>\n              <div v-show=\"!businessData.announcement_picture\">\n                <i class=\"el-icon-plus announcement-uploader-icon\"></i>\n                <div slot=\"tip\" class=\"el-upload__tip\">\n                  {{ $t(\"public.picInfo\") }}\n                </div>\n              </div>\n            </div>\n          </el-upload>\n        </div>\n      </el-form-item>\n\n      <el-form-item prop=\"logo\" class=\"avatar-uploader\">\n        <el-upload\n          action=\"\"\n          :show-file-list=\"false\"\n          :http-request=\"uploadFile\"\n          :before-upload=\"beforeAvatarUpload\"\n        >\n          <div class=\"avatar_loading\" v-show=\"avatarLoading\"></div>\n          <div v-show=\"!avatarLoading\">\n            <img\n              :src=\"businessData.logo\"\n              v-if=\"businessData.logo\"\n              class=\"avatar\"\n            />\n            <i class=\"el-icon-plus avatar-uploader-icon\"></i>\n            <div slot=\"tip\" class=\"el-upload__tip\">\n              {{ $t(\"public.picInfo\") }}\n            </div>\n          </div>\n        </el-upload>\n      </el-form-item>\n      <el-form-item class=\"lastItem\" style=\"width: 100%\">\n        <el-button\n          type=\"primary\"\n          :loading=\"isLoading\"\n          class=\"saveBtn\"\n          @click=\"handleSave\"\n          >{{ $t(\"btn.save\") }}</el-button\n        >\n      </el-form-item>\n    </el-form>\n  </el-card>\n</template>\n\n<script>\nimport { mapActions, mapState } from \"vuex\";\nimport { addPhoto } from \"@/util/aws.config.js\";\nimport { endLoading } from \"@/util/loading.js\";\nexport default {\n  created() {\n    let {\n      name,\n      do_business_end_minute,\n      do_business_start_minute,\n      announcement_picture,\n      logo,\n      is_open,\n      address,\n    } = this.shopInfo;\n    this.businessData = {\n      name,\n      do_business_end_minute: this.minutesToTime(do_business_end_minute),\n      do_business_start_minute: this.minutesToTime(do_business_start_minute),\n      announcement_picture,\n      logo,\n      is_open,\n      address,\n    };\n  },\n  data() {\n    return {\n      avatarLoading: false,\n      announcementLoading: false,\n      isLoading: false,\n      businessData: {},\n    };\n  },\n  computed: {\n    formRules() {\n      return {\n        is_open: [\n          {\n            required: true,\n            message: this.$t(\"commodity.descriptionErrMsg\"),\n            trigger: \"blur\",\n          },\n        ],\n        name: [\n          {\n            required: true,\n            message: this.$t(\"commodity.descriptionErrMsg\"),\n            trigger: \"blur\",\n          },\n        ],\n        address: [\n          {\n            required: true,\n            message: this.$t(\"commodity.descriptionErrMsg\"),\n            trigger: \"blur\",\n          },\n        ],\n        do_business_end_minute: [\n          {\n            required: true,\n            message: this.$t(\"commodity.descriptionErrMsg\"),\n            trigger: \"blur\",\n          },\n        ],\n        do_business_start_minute: [\n          {\n            required: true,\n            message: this.$t(\"commodity.descriptionErrMsg\"),\n            trigger: \"blur\",\n          },\n        ],\n        announcement_picture: [\n          {\n            required: true,\n            message: this.$t(\"commodity.descriptionErrMsg\"),\n            trigger: \"blur\",\n          },\n        ],\n        logo: [\n          {\n            required: true,\n            message: this.$t(\"commodity.descriptionErrMsg\"),\n            trigger: \"blur\",\n          },\n        ],\n      };\n    },\n    ...mapState({\n      shopId: (state) => state.user.loginData.id,\n      shopInfo: (state) => state.user.loginData,\n    }),\n  },\n  methods: {\n    // 将time转换为minutes\n    timeToMinutes(time) {\n      let minutes = parseInt(time.split(\":\")[0]);\n      return minutes * 60;\n    },\n    // minutes转换为time\n    minutesToTime(minutes) {\n      let hour = minutes / 60;\n      if (hour >= 10) {\n        return `${hour}:00`;\n      } else {\n        return `0${hour}:00`;\n      }\n    },\n    getShopInfo() {\n      let obj = {\n        shop_id: this.shopId,\n      };\n      return this.getShopBasicInfo(obj);\n    },\n    // change() {\n    //   let obj = {\n    //     shop_id: this.shopId,\n    //     business_status: Number(this.status),\n    //   };\n    //   this.setBusinessStatus(obj);\n    // },\n    beforeAvatarUpload(file) {\n      const isJPG = file.type === \"image/jpeg\" || \"image/png\";\n      const isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isJPG) {\n        this.$message.error(this.$t(\"error.picTypeErr\"));\n      }\n      if (!isLt2M) {\n        this.$message.error(this.$t(\"error.picMaxErr\"));\n      }\n    },\n    uploadFile(file) {\n      this.avatarLoading = true;\n      addPhoto(file).then(\n        (data) => {\n          this.avatarLoading = false;\n          endLoading();\n          this.businessData.logo = data.Location;\n        },\n        (err) => {\n          this.avatarLoading = false;\n          endLoading();\n          if (!err.msg) {\n            this.$message.error(this.$t(\"error.picUploadErr\"));\n          }\n        }\n      );\n    },\n    uploadAnnouncementPic(file) {\n      this.announcementLoading = true;\n      addPhoto(file).then(\n        (data) => {\n          this.announcementLoading = false;\n          endLoading();\n          this.businessData.announcement_picture = data.Location;\n        },\n        (err) => {\n          this.announcementLoading = false;\n          endLoading();\n          if (!err.msg) {\n            this.$message.error(this.$t(\"error.picUploadErr\"));\n          }\n        }\n      );\n    },\n    handleSave() {\n      this.$refs.form.validate((valid) => {\n        if (valid) {\n          this.isLoading = true;\n          let do_business_end_minute = this.timeToMinutes(\n            this.businessData.do_business_end_minute\n          );\n          let do_business_start_minute = this.timeToMinutes(\n            this.businessData.do_business_start_minute\n          );\n          let obj = {\n            ...this.businessData,\n            do_business_start_minute,\n            do_business_end_minute,\n          };\n          this.alterInfo(obj).then(\n            () => {\n              this.isLoading = false;\n              this.$message({\n                message: this.$t(\"store.successInfo\"),\n                type: \"success\",\n              });\n            },\n            () => {\n              this.isLoading = false;\n              this.$message.error(this.$t(\"error.serverErr\"));\n            }\n          );\n        }\n      });\n    },\n    ...mapActions({\n      //   setBusinessStatus: \"user/setBusinessStatus\",\n      saveInfo: \"user/saveStoreInformation\",\n      alterInfo: \"user/alterBusiness\",\n      getShopBasicInfo: \"user/getShopBasicInfo\",\n    }),\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.store-card {\n  // max-height: calc(100vh - 8em);\n  height: calc(100vh - 8em);\n  overflow-y: auto;\n}\n\n.store-form {\n  padding: 3em 8em 0em 8em;\n}\n\n.storeName .el-input-group__prepend {\n  width: 150px;\n  background-color: #fff !important;\n}\n\n.map {\n  border: 1px solid hsl(0, 0%, 85%);\n}\n\n.store-form {\n  position: relative;\n  min-height: calc(100vh - 220px);\n  .lastItem {\n    position: absolute;\n    bottom: -4m;\n  }\n}\n\n.saveBtn {\n  width: 20em;\n  margin-left: calc(50% - 130px - 10em);\n}\n\n.avatar-uploader {\n  position: absolute;\n  top: 3em;\n  right: 8em;\n}\n\n.avatar_loading {\n  height: 168px;\n  width: 168px;\n}\n\n::v-deep .avatar-uploader .el-upload {\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n\n.avatar-uploader .el-upload:hover {\n  border-color: #409eff;\n}\n\n.avatar-uploader-icon {\n  border: 1px dashed hsl(0, 0%, 85%);\n  font-size: 28px;\n  color: #8c939d;\n  width: 168px;\n  height: 168px;\n  line-height: 168px;\n  text-align: center;\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n.announcement-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 28px;\n  height: 28px;\n  line-height: 28px;\n  text-align: center;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n}\n\n.announcement_list {\n  width: 50%;\n  min-height: 100px;\n  margin-bottom: 15px;\n  margin-top: 15px;\n  text-align: left;\n  cursor: pointer;\n  padding: 8px;\n  border: 1px dashed #d9d9d9;\n  background-color: #d9e1eb;\n\n  position: relative;\n}\n::v-deep .el-upload {\n  display: block;\n}\n.announcement_pic {\n  width: 100%;\n}\n\n.avatar {\n  width: 168px;\n  height: 168px;\n  display: block;\n}\n\n@media screen and (max-width: 1400px) and (min-width: 1330px) {\n  .store-form {\n    padding: 3em 4em 0 4em;\n  }\n}\n\n@media screen and (max-width: 1330px) {\n  .store-form {\n    padding: 3em 4em 0 0;\n  }\n}\n@media screen and (max-height: 860px) {\n  .store-form {\n    position: relative;\n    height: calc(100vh - 220px);\n    .lastItem {\n      position: absolute;\n      top: 575px;\n      margin-bottom: 1em;\n    }\n  }\n}\n</style>\n","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=faeae460&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=faeae460&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"faeae460\",\n  null\n  \n)\n\nexport default component.exports","import { Loading } from 'element-ui'\n\nlet loadingInstance\n\nexport function startLoading(targetdq) {\n    let options = {\n        text: 'loading......',\n        background: 'rgba(255, 255, 255, 0.6)',\n        target: document.querySelector(targetdq) || 'body',\n        customClass: 'server_loading'\n    }\n    loadingInstance = Loading.service(options)\n}\n\nexport function endLoading() {\n    loadingInstance.close()\n}\n\n"],"sourceRoot":""}