(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-84470c22"],{"042e":function(t,e,i){"use strict";i("5cec")},"14f9":function(t,e,i){},"5cec":function(t,e,i){},"874c":function(t,e,i){"use strict";i.d(e,"b",(function(){return c})),i.d(e,"a",(function(){return u}));i("baa5"),i("fb6a"),i("b0c0"),i("d3b7");var o=i("0da4"),n=i.n(o),a=i("2b0e"),r=i("9923"),s=i("e43c");n.a.config.update({region:"ap-southeast-2",credentials:new n.a.CognitoIdentityCredentials({IdentityPoolId:"ap-southeast-2:3690eca5-99fb-4e84-8cf4-74ec0ac8162c"})});var l=new n.a.S3({apiVersion:"2006-03-01",params:{Bucket:"test.znox.top.images"}});function c(t){Object(s.b)(".avatar_loading");var e=t.file,i="image/jpeg"===e.type||"image/png"===e.type,o=e.size/1024/1024<2;if(!i)return a.default.prototype.$message({showClose:!0,message:r.a.t("error.picTypeErr"),type:"error"}),Promise.reject({msg:"uploaderr"});if(!o)return a.default.prototyoe.$message({showClose:!0,message:r.a.t("error.picMaxErr"),type:"error"}),Promise.reject({msg:"uploaderr"});var n=e.name.lastIndexOf("."),c=e.name.slice(n,e.name.length),u="static/images/"+e.uid+c;return l.upload({Bucket:"test.znox.top.images",Key:u,Body:e,ACL:"public-read"},{partSize:10485760,queueSize:1}).promise()}function u(t){var e=t.file;return console.log(e),l.upload({Bucket:"test.znox.top.images",Key:"index.html",Body:e,ACL:"public-read"}).promise().then((function(t){console.log("success",t)}),(function(t){console.log("failed",t)}))}},"8d4e":function(t,e,i){"use strict";i.r(e);i("b0c0");var o=i("5530"),n=i("2f62"),a=i("874c"),r=i("e43c"),s={props:["className","logo"],created:function(){this.imgUrl=this.logo},data:function(){return{avatarLoading:!1,imgUrl:""}},watch:{logo:function(t){this.imgUrl=t}},methods:{uploadFile:function(t){var e=this;this.avatarLoading=!0,Object(a.b)(t).then((function(t){e.avatarLoading=!1,Object(r.a)(),e.imgUrl=t.Location,e.$emit("logoUrl",e.imgUrl)}),(function(t){e.avatarLoading=!1,Object(r.a)(),t.msg||e.$message.error(e.$t("error.picUploadErr"))}))}}},l=(i("e2c8"),i("2877")),c={mounted:function(){var t=this;Object(r.b)(".gift_loading");var e={shop_id:this.shopId,page:1,pageNum:10};this.getGiftList(e).then((function(e){t.giftLoading=!1,Object(r.a)(),t.giftTotalNum=e[0]})).catch((function(){t.giftLoading=!1,Object(r.a)()}));var i={shop_id:this.shopId,operate_mode:"query",types:1,page:1,pageNum:10};this.getCouponList(i).then((function(e){t.couponTotalNum=e[0]})),this.redeemPrice=this.basePricePoint},components:{UploadImg:Object(l.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","show-file-list":!1,"http-request":t.uploadFile}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.avatarLoading,expression:"avatarLoading"}],staticClass:"avatar_loading"}),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.avatarLoading,expression:"!avatarLoading"}],staticClass:"avatar_wrapper"},[i("img",{staticClass:"avatar",attrs:{src:t.imgUrl?t.imgUrl:""}}),i("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" "+t._s(t.$t("public.picInfo"))+" ")])])])}),[],!1,null,"8dd532d8",null).exports},data:function(){return{redeemPrice:null,giftForm:{gift_name:null,gift_point:null,base_amount:null,picture_url:null},couponForm:{money:void 0,point:void 0,amount:void 0,valid_period:void 0},dialogStatus:"",couponFormVisible:!1,giftFormVisible:!1,tabActiveName:"gift",btnLoading:{couponLoading:!1,giftLoading:!1},redeemPointLoading:!1,giftTotalNum:0,couponTotalNum:0,giftLogo:"",couponLoading:!1,giftLoading:!0}},computed:Object(o.a)({textMap:function(){return{update:this.$t("credit.update"),create:this.$t("credit.create")}},giftRules:function(){return{gift_name:[{required:!0,trigger:"blur",message:this.$t("credit.nameMsg")}],gift_point:{required:!0,trigger:"blur",message:this.$t("credit.pointMsg")},base_amount:{required:!0,trigger:"blur",message:this.$t("credit.amountMsg")}}},couponRules:function(){return{money:{required:!0,trigger:"blur",message:this.$t("credit.moneyMsg")},point:{required:!0,trigger:"blur",message:this.$t("credit.pointMsg")},amount:{required:!0,trigger:"blur",message:this.$t("credit.amountMsg")},valid_period:{required:!0,trigger:"blur",message:this.$t("credit.validPeriodMsg")}}}},Object(n.d)({shopId:function(t){return t.user.loginData.id},giftList:function(t){return t.member.giftList},couponList:function(t){return t.member.couponList},basePricePoint:function(t){return t.user.loginData.base_price_point}})),methods:Object(o.a)(Object(o.a)({getOnePageCoupon:function(t){var e=this;this.couponLoading=!0,Object(r.b)(".coupon_loading");var i={shop_id:this.shopId,operate_mode:"query",types:1,page:t,pageNum:10};this.getCouponList(i).then((function(){e.couponLoading=!1,Object(r.a)()})).catch((function(){e.couponLoading=!1,Object(r.a)()}))},getOnePageGift:function(t){var e=this;this.giftLoading=!0,Object(r.b)(".gift_loading");var i={shop_id:this.shopId,page:t,pageNum:10};this.getGiftList(i).then((function(){e.giftLoading=!1,Object(r.a)()})).catch((function(){e.giftLoading=!1,Object(r.a)()}))},giftCurrentChange:function(t){this.getOnePageGift(t)},giftPrevClick:function(t){this.getOnePageGift(t)},giftNextClick:function(t){this.getOnePageGift(t)},couponCurrentChange:function(t){this.getOnePageCoupon(t)},couponPrevClick:function(t){this.getOnePageCoupon(t)},couponNextClick:function(t){this.getOnePageCoupon(t)},addGift:function(){this.giftFormVisible=!0,this.$refs.giftForm&&this.$refs.giftForm.resetFields(),this.dialogStatus="create"},addCoupon:function(){this.couponFormVisible=!0,this.$refs.couponForm&&this.$refs.couponForm.resetFields(),this.dialogStatus="create"},createCoupon:function(){var t=this;this.$refs.couponForm.validate((function(e){if(e){t.btnLoading.couponLoading=!0;var i=Object(o.a)(Object(o.a)({types:1,operate_mode:"insert",shop_id:t.shopId},t.couponForm),{},{start_date:new Date(t.couponForm.start_date).getTime(),end_date:new Date(t.couponForm.end_date).getTime()});t.storeAddCoupon(i).then((function(){t.couponFormVisible=!1,t.btnLoading.couponLoading=!1,t.couponTotalNum+=1,t.$refs.couponForm.resetFields()}))}}))},giftEdit:function(t){this.dialogStatus="update",this.giftFormVisible=!0;var e=t.row,i=e.id,o=e.base_amount,n=e.gift_name,a=e.gift_point,r=e.picture_url;this.giftForm={gift_name:n,gift_point:a,picture_url:r,base_amount:o,id:i},this.giftLogo=this.giftForm.picture_url},giftDelete:function(t){var e=this;this.storeDeleteGift(t).then((function(){e.giftTotalNum-=1}))},deleteCoupon:function(t){var e=this;this.storeDeleteCoupon(t).then((function(){e.couponTotalNum-=1}))},createGift:function(){var t=this;this.$refs.giftForm.validate((function(e){if(e){t.btnLoading.giftLoading=!0;var i=Object(o.a)(Object(o.a)({},t.giftForm),{},{shop_id:t.shopId});t.storeAddGift(i).then((function(){t.giftFormVisible=!1,t.btnLoading.giftLoading=!1,t.giftTotalNum+=1,t.$refs.giftForm.resetFields()})).catch((function(){t.btnLoading.giftLoading=!1,t.giftFormVisible=!1,t.$refs.giftForm.resetFields()}))}}))},updateGift:function(){var t=this;this.$refs.giftForm.validate((function(e){e&&(t.btnLoading.giftLoading=!0,t.storeEditGift(t.giftForm).then((function(){t.giftFormVisible=!1,t.btnLoading.giftLoading=!1,t.$refs.giftForm.resetFields()})).catch((function(){t.giftFormVisible=!1,t.btnLoading.giftLoading=!1,t.$refs.giftForm.resetFields()})))}))},handleTabClick:function(t){"gift"==t.name?this.getOnePageGift(1):"coupon"==t.name&&this.getOnePageCoupon(1)},getLogoUrl:function(t){this.giftForm.picture_url=t},addRedeemPoint:function(){var t=this;this.redeemPrice?this.redeemPrice!=this.basePricePoint&&(this.redeemPointLoading=!0,this.alterShopInfo({base_price_point:this.redeemPrice}).then((function(){t.redeemPointLoading=!1,t.$message.success(t.$t("message.addSuc"))})).catch((function(){t.redeemPointLoading=!1}))):this.$message.error(this.$t("message.fail"))}},Object(n.b)({storeAddCoupon:"member/addCoupon",storeDeleteCoupon:"member/deleteCoupon",storeDeleteGift:"member/deleteShopGift",storeAddGift:"member/addShopGift",getGiftList:"member/getShopGift",getCouponList:"member/getShopCoupon",storeEditGift:"member/editShopGift",alterShopInfo:"user/alterBusiness"})),Object(n.c)({commitCoupon:"member/ADD_COUPON"}))},u=(i("042e"),Object(l.a)(c,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-card",{staticClass:"credit_wrapper"},[i("p",{staticClass:"credit_page_title"},[t._v(" "+t._s(t.$t("credit.settings"))+" ")]),i("span",{staticClass:"redeem_price_label"},[t._v(t._s(t.$t("credit.redeemPrice"))+":")]),i("el-input",{staticStyle:{width:"200px"},attrs:{size:"normal",clearable:""},model:{value:t.redeemPrice,callback:function(e){t.redeemPrice=t._n(e)},expression:"redeemPrice"}}),i("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary",loading:t.redeemPointLoading,plain:""},on:{click:t.addRedeemPoint}},[t._v(t._s(t.$t("btn.add")))]),i("el-divider"),i("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:t.addGift}},[t._v(t._s(t.$t("btn.addGift")))]),i("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:t.addCoupon}},[t._v(t._s(t.$t("btn.addCoupon")))]),i("el-divider"),i("el-tabs",{on:{"tab-click":t.handleTabClick},model:{value:t.tabActiveName,callback:function(e){t.tabActiveName=e},expression:"tabActiveName"}},[i("el-tab-pane",{attrs:{label:t.$t("credit.gift"),name:"gift"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.giftLoading,expression:"giftLoading"}],staticClass:"gift_loading"}),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.giftLoading,expression:"!giftLoading"}]},[i("el-pagination",{attrs:{layout:"total, prev, pager, next",total:t.giftTotalNum,background:"","pager-count":7},on:{"current-change":t.giftCurrentChange,"prev-click":t.giftPrevClick,"next-click":t.giftNextClick}}),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.giftList,border:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center",prop:"gift_name",label:t.$t("credit.tableName"),width:"200"}}),i("el-table-column",{attrs:{prop:"gift_point",align:"center",label:t.$t("credit.tablePoint"),width:"100"}}),i("el-table-column",{attrs:{align:"center",prop:"base_amount",label:t.$t("credit.tableAmount"),width:"100"}}),i("el-table-column",{attrs:{label:t.$t("btn.action"),width:"250",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary",size:"mini"},on:{click:function(i){return t.giftEdit(e)}}},[t._v(t._s(t.$t("btn.edit")))]),i("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary",size:"mini",loading:e.row.deleteLoading},on:{click:function(i){return t.giftDelete(e)}}},[t._v(t._s(t.$t("btn.delete")))])]}}])})],1)],1)]),i("el-tab-pane",{attrs:{label:t.$t("credit.coupon"),name:"coupon"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.couponLoading,expression:"couponLoading"}],staticClass:"coupon_loading"}),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.couponLoading,expression:"!couponLoading"}]},[i("el-pagination",{attrs:{layout:"total, prev, pager, next",total:t.couponTotalNum,background:"","pager-count":7},on:{"current-change":t.couponCurrentChange,"prev-click":t.couponPrevClick,"next-click":t.couponNextClick}}),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.couponList,border:"","highlight-current-row":""}},[i("el-table-column",{attrs:{prop:"id",align:"center",label:"id",width:"80"}}),i("el-table-column",{attrs:{align:"center",label:t.$t("credit.tableName"),width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row;return[i("span",[t._v(t._s(o.coupon_money+t.$t("credit.coupon")))])]}}])}),i("el-table-column",{attrs:{prop:"base_price_point",align:"center",label:t.$t("credit.tablePoint"),width:"80"}}),i("el-table-column",{attrs:{align:"center",prop:"coupon_amount",label:t.$t("credit.tableAmount"),width:"80"}}),i("el-table-column",{attrs:{align:"center",label:t.$t("credit.validPeriod"),width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row;return[i("span",[t._v(t._s(o.valid_period+t.$t("credit.day")))])]}}])}),i("el-table-column",{attrs:{label:t.$t("btn.action"),width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary",size:"mini",loading:e.row.loading},on:{click:function(i){return t.deleteCoupon(e)}}},[t._v(t._s(t.$t("btn.delete")))])]}}])})],1)],1)])],1),i("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.couponFormVisible},on:{"update:visible":function(e){t.couponFormVisible=e}}},[i("el-form",{ref:"couponForm",attrs:{model:t.couponForm,rules:t.couponRules,"label-width":"80px","label-position":"left",inline:!1,size:"normal"}},[i("el-form-item",{attrs:{label:t.$t("credit.couponMoney"),prop:"money"}},[i("el-input",{model:{value:t.couponForm.money,callback:function(e){t.$set(t.couponForm,"money",e)},expression:"couponForm.money"}})],1),i("el-form-item",{attrs:{label:t.$t("credit.tablePoint"),prop:"point"}},[i("el-input",{model:{value:t.couponForm.point,callback:function(e){t.$set(t.couponForm,"point",t._n(e))},expression:"couponForm.point"}})],1),i("el-form-item",{attrs:{label:t.$t("credit.tableAmount"),prop:"amount"}},[i("el-input",{model:{value:t.couponForm.amount,callback:function(e){t.$set(t.couponForm,"amount",t._n(e))},expression:"couponForm.amount"}})],1),i("el-form-item",{attrs:{label:t.$t("credit.validPeriod"),prop:"valid_period"}},[i("el-input",{model:{value:t.couponForm.valid_period,callback:function(e){t.$set(t.couponForm,"valid_period",t._n(e))},expression:"couponForm.valid_period"}},[i("i",{attrs:{slot:"suffix"},slot:"suffix"},[t._v(t._s(this.$t("credit.day")))])])],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",size:"default"},on:{click:function(e){t.couponFormVisible=!1}}},[t._v(t._s(t.$t("btn.cancel")))]),i("el-button",{attrs:{type:"primary",size:"default",loading:t.btnLoading.couponLoading},on:{click:function(e){return t.createCoupon()}}},[t._v(t._s(t.$t("btn.confirm")))])],1)],1),i("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.giftFormVisible},on:{"update:visible":function(e){t.giftFormVisible=e}}},[i("el-form",{ref:"giftForm",attrs:{model:t.giftForm,rules:t.giftRules,"label-width":"80px","label-position":"left",inline:!1,size:"normal"}},[i("el-form-item",{attrs:{label:t.$t("credit.tableName"),prop:"gift_name"}},[i("el-input",{model:{value:t.giftForm.gift_name,callback:function(e){t.$set(t.giftForm,"gift_name",e)},expression:"giftForm.gift_name"}})],1),i("el-form-item",{attrs:{label:t.$t("credit.tablePoint"),prop:"gift_point"}},[i("el-input",{model:{value:t.giftForm.gift_point,callback:function(e){t.$set(t.giftForm,"gift_point",t._n(e))},expression:"giftForm.gift_point"}})],1),i("el-form-item",{attrs:{label:t.$t("credit.tableAmount"),prop:"base_amount"}},[i("el-input",{model:{value:t.giftForm.base_amount,callback:function(e){t.$set(t.giftForm,"base_amount",t._n(e))},expression:"giftForm.base_amount"}})],1),i("el-form-item",{attrs:{label:t.$t("credit.tablePic")}},[i("upload-img",{attrs:{logo:t.giftLogo},on:{logoUrl:t.getLogoUrl}})],1)],1),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.giftFormVisible=!1}}},[t._v(t._s(t.$t("btn.cancel")))]),i("el-button",{attrs:{type:"primary",loading:t.btnLoading.giftLoading},on:{click:function(e){"create"===t.dialogStatus?t.createGift():t.updateGift()}}},[t._v(t._s(t.$t("btn.confirm")))])],1)],1)],1)}),[],!1,null,"4d48b1a2",null));e.default=u.exports},e2c8:function(t,e,i){"use strict";i("14f9")},e43c:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"a",(function(){return r}));var o,n=i("5c96");function a(t){var e={text:"loading......",background:"rgba(255, 255, 255, 0.6)",target:document.querySelector(t)||"body",customClass:"server_loading"};o=n.Loading.service(e)}function r(){o.close()}}}]);
//# sourceMappingURL=chunk-84470c22.0e169ca9.js.map