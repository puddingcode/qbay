{"version":3,"sources":["webpack:///./src/util/aws.config.js","webpack:///./src/views/credit/index.vue?42d9","webpack:///./src/components/UploadImg.vue?3aa1","webpack:///src/components/UploadImg.vue","webpack:///./src/views/credit/index.vue?027d","webpack:///src/views/credit/index.vue","webpack:///./src/components/UploadImg.vue","webpack:///./src/components/UploadImg.vue?b6eb","webpack:///./src/views/credit/index.vue","webpack:///./src/views/credit/index.vue?c3de","webpack:///./src/components/UploadImg.vue?652c","webpack:///./src/util/loading.js"],"names":["AWS","config","update","region","credentials","CognitoIdentityCredentials","IdentityPoolId","s3","S3","apiVersion","params","Bucket","addPhoto","files","startLoading","file","isJPG","type","isLt2M","size","Vue","prototype","$message","showClose","message","i18n","t","Promise","reject","msg","prototyoe","index","name","lastIndexOf","suffix","slice","length","photoKey","uid","upload","Key","Body","ACL","partSize","queueSize","promise","addIndex","console","log","then","data","err","props","created","this","imgUrl","logo","avatarLoading","watch","value","methods","uploadFile","shop_id","shopId","page","pageNum","getGiftList","giftObj","operate_mode","types","getCouponList","couponObj","redeemPrice","basePricePoint","components","UploadImg","_vm","_h","$createElement","_c","_self","staticClass","attrs","directives","rawName","expression","slot","_v","_s","$t","giftForm","gift_name","gift_point","base_amount","picture_url","couponForm","money","undefined","point","amount","valid_period","dialogStatus","couponFormVisible","giftFormVisible","tabActiveName","btnLoading","couponLoading","giftLoading","redeemPointLoading","giftTotalNum","couponTotalNum","giftLogo","computed","textMap","create","giftRules","required","trigger","couponRules","getOnePageCoupon","getOnePageGift","giftCurrentChange","giftPrevClick","giftNextClick","couponCurrentChange","couponPrevClick","couponNextClick","addGift","$refs","resetFields","addCoupon","createCoupon","validate","valid","start_date","Date","end_date","giftEdit","scope","row","id","giftDelete","storeDeleteGift","deleteCoupon","storeDeleteCoupon","createGift","updateGift","handleTabClick","tab","event","couponList","getLogoUrl","addRedeemPoint","alterShopInfo","base_price_point","staticStyle","model","callback","$$v","_n","on","giftList","scopedSlots","_u","key","fn","$event","deleteLoading","ref","coupon_money","loading","$set","loadingInstance","targetdq","options","text","background","target","document","querySelector","customClass","Loading","service","endLoading","close"],"mappings":"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","file":"js/chunk-51e57f74.b1973cc4.js","sourcesContent":["import AWS from 'aws-sdk';\nimport Vue from 'vue';\nimport i18n from '@/lang/index.js';\nimport { startLoading } from '@/util/loading.js';\nvar albumBucketName = 'test.znox.top.images';\nvar bucketRegion = 'ap-southeast-2';\nvar IdentityPoolId = 'ap-southeast-2:3690eca5-99fb-4e84-8cf4-74ec0ac8162c';\n\nAWS.config.update({\n  region: bucketRegion,\n  credentials: new AWS.CognitoIdentityCredentials({\n    IdentityPoolId: IdentityPoolId,\n  }),\n});\n\nvar s3 = new AWS.S3({\n  apiVersion: '2006-03-01',\n  params: {\n    Bucket: albumBucketName,\n  },\n});\n\n// 添加照片\nexport function addPhoto(files) {\n  startLoading('.avatar_loading');\n  const file = files.file;\n  const isJPG = file.type === 'image/jpeg' || file.type === 'image/png';\n  const isLt2M = file.size / 1024 / 1024 < 2;\n\n  if (!isJPG) {\n    Vue.prototype.$message({\n      showClose: true,\n      message: i18n.t('error.picTypeErr'),\n      type: 'error',\n    });\n    return Promise.reject({ msg: 'uploaderr' });\n  }\n  if (!isLt2M) {\n    Vue.prototyoe.$message({\n      showClose: true,\n      message: i18n.t('error.picMaxErr'),\n      type: 'error',\n    });\n    return Promise.reject({ msg: 'uploaderr' });\n  }\n  let index = file.name.lastIndexOf('.');\n  let suffix = file.name.slice(index, file.name.length);\n  let photoKey = 'static/images/' + file.uid + suffix;\n  let options = {\n    partSize: 10 * 1024 * 1024,\n    queueSize: 1,\n  };\n  return s3\n    .upload(\n      {\n        Bucket: albumBucketName,\n        Key: photoKey,\n        Body: file,\n        ACL: 'public-read',\n      },\n      options\n    )\n    .promise();\n}\n\nexport function addIndex(files) {\n  const file = files.file;\n  console.log(file);\n  return s3\n    .upload({\n      Bucket: albumBucketName,\n      Key: 'index.html',\n      Body: file,\n      ACL: 'public-read',\n    })\n    .promise()\n    .then(\n      (data) => {\n        console.log('success', data);\n      },\n      (err) => {\n        console.log('failed', err);\n      }\n    );\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-card',{staticClass:\"credit_wrapper\"},[_c('p',{staticClass:\"credit_page_title\"},[_vm._v(\" \"+_vm._s(_vm.$t(\"credit.settings\"))+\" \")]),_c('span',{staticClass:\"redeem_price_label\"},[_vm._v(_vm._s(_vm.$t(\"credit.redeemPrice\"))+\":\")]),_c('el-input',{staticStyle:{\"width\":\"200px\"},attrs:{\"size\":\"normal\",\"clearable\":\"\"},model:{value:(_vm.redeemPrice),callback:function ($$v) {_vm.redeemPrice=_vm._n($$v)},expression:\"redeemPrice\"}}),_c('el-button',{staticStyle:{\"width\":\"100px\"},attrs:{\"type\":\"primary\",\"loading\":_vm.redeemPointLoading,\"plain\":\"\"},on:{\"click\":_vm.addRedeemPoint}},[_vm._v(_vm._s(_vm.$t(\"btn.add\")))]),_c('el-divider'),_c('el-button',{attrs:{\"type\":\"primary\",\"plain\":\"\",\"size\":\"small\"},on:{\"click\":_vm.addGift}},[_vm._v(_vm._s(_vm.$t(\"btn.addGift\")))]),_c('el-button',{attrs:{\"type\":\"primary\",\"plain\":\"\",\"size\":\"small\"},on:{\"click\":_vm.addCoupon}},[_vm._v(_vm._s(_vm.$t(\"btn.addCoupon\")))]),_c('el-divider'),_c('el-tabs',{on:{\"tab-click\":_vm.handleTabClick},model:{value:(_vm.tabActiveName),callback:function ($$v) {_vm.tabActiveName=$$v},expression:\"tabActiveName\"}},[_c('el-tab-pane',{attrs:{\"label\":_vm.$t('credit.gift'),\"name\":\"gift\"}},[_c('el-pagination',{attrs:{\"layout\":\"total, prev, pager, next\",\"total\":_vm.giftTotalNum,\"background\":\"\",\"pager-count\":7},on:{\"current-change\":_vm.giftCurrentChange,\"prev-click\":_vm.giftPrevClick,\"next-click\":_vm.giftNextClick}}),_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.giftList,\"border\":\"\",\"highlight-current-row\":\"\"}},[_c('el-table-column',{attrs:{\"align\":\"center\",\"prop\":\"gift_name\",\"label\":_vm.$t('credit.tableName'),\"width\":\"200\"}}),_c('el-table-column',{attrs:{\"prop\":\"gift_point\",\"align\":\"center\",\"label\":_vm.$t('credit.tablePoint'),\"width\":\"100\"}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"prop\":\"base_amount\",\"label\":_vm.$t('credit.tableAmount'),\"width\":\"100\"}}),_c('el-table-column',{attrs:{\"label\":_vm.$t('btn.action'),\"width\":\"250\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{staticStyle:{\"width\":\"100px\"},attrs:{\"type\":\"primary\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.giftEdit(scope)}}},[_vm._v(_vm._s(_vm.$t(\"btn.edit\")))]),_c('el-button',{staticStyle:{\"width\":\"100px\"},attrs:{\"type\":\"primary\",\"size\":\"mini\",\"loading\":scope.row.deleteLoading},on:{\"click\":function($event){return _vm.giftDelete(scope)}}},[_vm._v(_vm._s(_vm.$t(\"btn.delete\")))])]}}])})],1)],1),_c('el-tab-pane',{attrs:{\"label\":_vm.$t('credit.coupon'),\"name\":\"coupon\"}},[_c('el-pagination',{attrs:{\"layout\":\"total, prev, pager, next\",\"total\":_vm.couponTotalNum,\"background\":\"\",\"pager-count\":7},on:{\"current-change\":_vm.couponCurrentChange,\"prev-click\":_vm.couponPrevClick,\"next-click\":_vm.couponNextClick}}),_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.couponList,\"border\":\"\",\"highlight-current-row\":\"\"}},[_c('el-table-column',{attrs:{\"prop\":\"id\",\"align\":\"center\",\"label\":\"id\",\"width\":\"80\"}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":_vm.$t('credit.tableName'),\"width\":\"200\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('span',[_vm._v(_vm._s(row.coupon_money + _vm.$t(\"credit.coupon\")))])]}}])}),_c('el-table-column',{attrs:{\"prop\":\"base_price_point\",\"align\":\"center\",\"label\":_vm.$t('credit.tablePoint'),\"width\":\"80\"}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"prop\":\"coupon_amount\",\"label\":_vm.$t('credit.tableAmount'),\"width\":\"80\"}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":_vm.$t('credit.validPeriod'),\"width\":\"250\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('span',[_vm._v(_vm._s(row.valid_period + _vm.$t(\"credit.day\")))])]}}])}),_c('el-table-column',{attrs:{\"label\":_vm.$t('btn.action'),\"width\":\"200\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{staticStyle:{\"width\":\"100px\"},attrs:{\"type\":\"primary\",\"size\":\"mini\",\"loading\":scope.row.loading},on:{\"click\":function($event){return _vm.deleteCoupon(scope)}}},[_vm._v(_vm._s(_vm.$t(\"btn.delete\")))])]}}])})],1)],1)],1),_c('el-dialog',{attrs:{\"title\":_vm.textMap[_vm.dialogStatus],\"visible\":_vm.couponFormVisible},on:{\"update:visible\":function($event){_vm.couponFormVisible=$event}}},[_c('el-form',{ref:\"couponForm\",attrs:{\"model\":_vm.couponForm,\"rules\":_vm.couponRules,\"label-width\":\"80px\",\"label-position\":\"left\",\"inline\":false,\"size\":\"normal\"}},[_c('el-form-item',{attrs:{\"label\":_vm.$t('credit.couponMoney'),\"prop\":\"money\"}},[_c('el-input',{model:{value:(_vm.couponForm.money),callback:function ($$v) {_vm.$set(_vm.couponForm, \"money\", $$v)},expression:\"couponForm.money\"}})],1),_c('el-form-item',{attrs:{\"label\":_vm.$t('credit.tablePoint'),\"prop\":\"point\"}},[_c('el-input',{model:{value:(_vm.couponForm.point),callback:function ($$v) {_vm.$set(_vm.couponForm, \"point\", _vm._n($$v))},expression:\"couponForm.point\"}})],1),_c('el-form-item',{attrs:{\"label\":_vm.$t('credit.tableAmount'),\"prop\":\"amount\"}},[_c('el-input',{model:{value:(_vm.couponForm.amount),callback:function ($$v) {_vm.$set(_vm.couponForm, \"amount\", _vm._n($$v))},expression:\"couponForm.amount\"}})],1),_c('el-form-item',{attrs:{\"label\":_vm.$t('credit.validPeriod'),\"prop\":\"valid_period\"}},[_c('el-input',{model:{value:(_vm.couponForm.valid_period),callback:function ($$v) {_vm.$set(_vm.couponForm, \"valid_period\", _vm._n($$v))},expression:\"couponForm.valid_period\"}},[_c('i',{attrs:{\"slot\":\"suffix\"},slot:\"suffix\"},[_vm._v(_vm._s(this.$t(\"credit.day\")))])])],1)],1),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"default\"},on:{\"click\":function($event){_vm.couponFormVisible = false}}},[_vm._v(_vm._s(_vm.$t(\"btn.cancel\")))]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"default\",\"loading\":_vm.btnLoading.couponLoading},on:{\"click\":function($event){return _vm.createCoupon()}}},[_vm._v(_vm._s(_vm.$t(\"btn.confirm\")))])],1)],1),_c('el-dialog',{attrs:{\"title\":_vm.textMap[_vm.dialogStatus],\"visible\":_vm.giftFormVisible},on:{\"update:visible\":function($event){_vm.giftFormVisible=$event}}},[_c('el-form',{ref:\"giftForm\",attrs:{\"model\":_vm.giftForm,\"rules\":_vm.giftRules,\"label-width\":\"80px\",\"label-position\":\"left\",\"inline\":false,\"size\":\"normal\"}},[_c('el-form-item',{attrs:{\"label\":_vm.$t('credit.tableName'),\"prop\":\"gift_name\"}},[_c('el-input',{model:{value:(_vm.giftForm.gift_name),callback:function ($$v) {_vm.$set(_vm.giftForm, \"gift_name\", $$v)},expression:\"giftForm.gift_name\"}})],1),_c('el-form-item',{attrs:{\"label\":_vm.$t('credit.tablePoint'),\"prop\":\"gift_point\"}},[_c('el-input',{model:{value:(_vm.giftForm.gift_point),callback:function ($$v) {_vm.$set(_vm.giftForm, \"gift_point\", _vm._n($$v))},expression:\"giftForm.gift_point\"}})],1),_c('el-form-item',{attrs:{\"label\":_vm.$t('credit.tableAmount'),\"prop\":\"base_amount\"}},[_c('el-input',{model:{value:(_vm.giftForm.base_amount),callback:function ($$v) {_vm.$set(_vm.giftForm, \"base_amount\", _vm._n($$v))},expression:\"giftForm.base_amount\"}})],1),_c('el-form-item',{attrs:{\"label\":_vm.$t('credit.tablePic')}},[_c('upload-img',{attrs:{\"logo\":_vm.giftLogo},on:{\"logoUrl\":_vm.getLogoUrl}})],1)],1),_c('span',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.giftFormVisible = false}}},[_vm._v(_vm._s(_vm.$t(\"btn.cancel\")))]),_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.btnLoading.giftLoading},on:{\"click\":function($event){_vm.dialogStatus === 'create' ? _vm.createGift() : _vm.updateGift()}}},[_vm._v(_vm._s(_vm.$t(\"btn.confirm\")))])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UploadImg.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UploadImg.vue?vue&type=script&lang=js&\"","<!--\n * @Author: your name\n * @Date: 1970-01-01 08:00:00\n * @LastEditTime: 2021-01-21 14:17:08\n * @LastEditors: Please set LastEditors\n * @Description: In User Settings Edit\n * @FilePath: /webAdmin/src/components/UploadImg.vue\n-->\n<template>\n  <el-upload\n    class=\"avatar-uploader\"\n    action=\"\"\n    :show-file-list=\"false\"\n    :http-request=\"uploadFile\"\n  >\n    <div class=\"avatar_loading\" v-show=\"avatarLoading\"></div>\n    <div v-show=\"!avatarLoading\" class=\"avatar_wrapper\">\n      <img :src=\"imgUrl ? imgUrl : ''\" class=\"avatar\" />\n      <i class=\"el-icon-plus avatar-uploader-icon\"></i>\n      <div slot=\"tip\" class=\"el-upload__tip\">\n        {{ $t(\"public.picInfo\") }}\n      </div>\n    </div>\n  </el-upload>\n</template>\n\n<script>\nimport { addPhoto } from \"@/util/aws.config.js\";\nimport { endLoading } from \"@/util/loading.js\";\nexport default {\n  props: [\"className\", \"logo\"],\n  created() {\n    this.imgUrl = this.logo;\n  },\n  data() {\n    return {\n      avatarLoading: false,\n      imgUrl: \"\",\n    };\n  },\n  watch: {\n    logo: function(value) {\n      this.imgUrl = value;\n    },\n  },\n  methods: {\n    uploadFile(file) {\n      this.avatarLoading = true;\n      addPhoto(file).then(\n        (data) => {\n          this.avatarLoading = false;\n          endLoading();\n          this.imgUrl = data.Location;\n          this.$emit(\"logoUrl\", this.imgUrl);\n        },\n        (err) => {\n          this.avatarLoading = false;\n          endLoading();\n          if (!err.msg) {\n            this.$message.error(this.$t(\"error.picUploadErr\"));\n          }\n        }\n      );\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n::v-deep .avatar-uploader .el-upload {\n  border: 1px dashed hsl(0, 0%, 85%);\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n\n.avatar-uploader .el-upload:hover {\n  border-color: #409eff;\n}\n\n.avatar_wrapper {\n  position: relative;\n}\n.avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 178px;\n  height: 178px;\n  line-height: 178px;\n  text-align: center;\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n\n.avatar {\n  width: 178px;\n  height: 178px;\n  display: block;\n}\n\n.avatar_loading {\n  height: 178px;\n  width: 178px;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","<!--\n * @Author: yin\n * @Date: 1970-01-01 08:00:00\n * @LastEditTime: 2021-02-28 22:12:39\n * @LastEditors: Please set LastEditors\n * @Description: In User Settings Edit\n * @FilePath: /webAdmin/src/views/credit/index.vue\n-->\n<template>\n  <el-card class=\"credit_wrapper\">\n    <p class=\"credit_page_title\">\n      {{ $t(\"credit.settings\") }}\n    </p>\n    <span class=\"redeem_price_label\">{{ $t(\"credit.redeemPrice\") }}:</span>\n    <el-input\n      v-model.number=\"redeemPrice\"\n      size=\"normal\"\n      clearable\n      style=\"width: 200px\"\n    ></el-input>\n    <el-button\n      type=\"primary\"\n      :loading=\"redeemPointLoading\"\n      plain\n      @click=\"addRedeemPoint\"\n      style=\"width: 100px\"\n      >{{ $t(\"btn.add\") }}</el-button\n    >\n    <el-divider></el-divider>\n    <el-button type=\"primary\" plain size=\"small\" @click=\"addGift\">{{\n      $t(\"btn.addGift\")\n    }}</el-button>\n    <el-button type=\"primary\" plain size=\"small\" @click=\"addCoupon\">{{\n      $t(\"btn.addCoupon\")\n    }}</el-button>\n    <el-divider></el-divider>\n\n    <el-tabs v-model=\"tabActiveName\" @tab-click=\"handleTabClick\">\n      <el-tab-pane :label=\"$t('credit.gift')\" name=\"gift\">\n        <el-pagination\n          @current-change=\"giftCurrentChange\"\n          layout=\"total, prev, pager, next\"\n          :total=\"giftTotalNum\"\n          @prev-click=\"giftPrevClick\"\n          @next-click=\"giftNextClick\"\n          background\n          :pager-count=\"7\"\n        >\n        </el-pagination>\n\n        <el-table\n          :data=\"giftList\"\n          border\n          highlight-current-row\n          style=\"width: 100%\"\n        >\n          <el-table-column\n            align=\"center\"\n            prop=\"gift_name\"\n            :label=\"$t('credit.tableName')\"\n            width=\"200\"\n          >\n          </el-table-column>\n          <el-table-column\n            prop=\"gift_point\"\n            align=\"center\"\n            :label=\"$t('credit.tablePoint')\"\n            width=\"100\"\n          >\n          </el-table-column>\n          <el-table-column\n            align=\"center\"\n            prop=\"base_amount\"\n            :label=\"$t('credit.tableAmount')\"\n            width=\"100\"\n          >\n          </el-table-column>\n\n          <el-table-column :label=\"$t('btn.action')\" width=\"250\" align=\"center\">\n            <template slot-scope=\"scope\">\n              <el-button\n                type=\"primary\"\n                size=\"mini\"\n                @click=\"giftEdit(scope)\"\n                style=\"width: 100px\"\n                >{{ $t(\"btn.edit\") }}</el-button\n              >\n\n              <el-button\n                type=\"primary\"\n                size=\"mini\"\n                :loading=\"scope.row.deleteLoading\"\n                @click=\"giftDelete(scope)\"\n                style=\"width: 100px\"\n                >{{ $t(\"btn.delete\") }}</el-button\n              >\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-tab-pane>\n      <el-tab-pane :label=\"$t('credit.coupon')\" name=\"coupon\">\n        <el-pagination\n          @current-change=\"couponCurrentChange\"\n          layout=\"total, prev, pager, next\"\n          :total=\"couponTotalNum\"\n          @prev-click=\"couponPrevClick\"\n          @next-click=\"couponNextClick\"\n          background\n          :pager-count=\"7\"\n        >\n        </el-pagination>\n        <el-table\n          :data=\"couponList\"\n          border\n          highlight-current-row\n          style=\"width: 100%\"\n        >\n          <el-table-column prop=\"id\" align=\"center\" label=\"id\" width=\"80\">\n          </el-table-column>\n          <el-table-column\n            align=\"center\"\n            :label=\"$t('credit.tableName')\"\n            width=\"200\"\n          >\n            <template slot-scope=\"{ row }\">\n              <span>{{ row.coupon_money + $t(\"credit.coupon\") }}</span>\n            </template>\n          </el-table-column>\n          <el-table-column\n            prop=\"base_price_point\"\n            align=\"center\"\n            :label=\"$t('credit.tablePoint')\"\n            width=\"80\"\n          >\n          </el-table-column>\n          <el-table-column\n            align=\"center\"\n            prop=\"coupon_amount\"\n            :label=\"$t('credit.tableAmount')\"\n            width=\"80\"\n          >\n          </el-table-column>\n\n          <el-table-column\n            align=\"center\"\n            :label=\"$t('credit.validPeriod')\"\n            width=\"250\"\n          >\n            <template slot-scope=\"{ row }\">\n              <span>{{ row.valid_period + $t(\"credit.day\") }}</span>\n            </template>\n          </el-table-column>\n\n          <el-table-column :label=\"$t('btn.action')\" width=\"200\" align=\"center\">\n            <template slot-scope=\"scope\">\n              <el-button\n                type=\"primary\"\n                size=\"mini\"\n                style=\"width: 100px\"\n                :loading=\"scope.row.loading\"\n                @click=\"deleteCoupon(scope)\"\n                >{{ $t(\"btn.delete\") }}</el-button\n              >\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-tab-pane>\n    </el-tabs>\n\n    <el-dialog :title=\"textMap[dialogStatus]\" :visible.sync=\"couponFormVisible\">\n      <el-form\n        :model=\"couponForm\"\n        ref=\"couponForm\"\n        :rules=\"couponRules\"\n        label-width=\"80px\"\n        label-position=\"left\"\n        :inline=\"false\"\n        size=\"normal\"\n      >\n        <el-form-item :label=\"$t('credit.couponMoney')\" prop=\"money\">\n          <el-input v-model=\"couponForm.money\"></el-input>\n        </el-form-item>\n        <el-form-item :label=\"$t('credit.tablePoint')\" prop=\"point\">\n          <el-input v-model.number=\"couponForm.point\"></el-input>\n        </el-form-item>\n        <el-form-item :label=\"$t('credit.tableAmount')\" prop=\"amount\">\n          <el-input v-model.number=\"couponForm.amount\"></el-input>\n        </el-form-item>\n        <el-form-item :label=\"$t('credit.validPeriod')\" prop=\"valid_period\">\n          <el-input v-model.number=\"couponForm.valid_period\">\n            <i slot=\"suffix\">{{ this.$t(\"credit.day\") }}</i>\n          </el-input>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button\n          type=\"primary\"\n          size=\"default\"\n          @click=\"couponFormVisible = false\"\n          >{{ $t(\"btn.cancel\") }}</el-button\n        >\n        <el-button\n          type=\"primary\"\n          size=\"default\"\n          @click=\"createCoupon()\"\n          :loading=\"btnLoading.couponLoading\"\n          >{{ $t(\"btn.confirm\") }}</el-button\n        >\n      </div>\n    </el-dialog>\n    <el-dialog :title=\"textMap[dialogStatus]\" :visible.sync=\"giftFormVisible\">\n      <el-form\n        :model=\"giftForm\"\n        ref=\"giftForm\"\n        :rules=\"giftRules\"\n        label-width=\"80px\"\n        label-position=\"left\"\n        :inline=\"false\"\n        size=\"normal\"\n      >\n        <el-form-item :label=\"$t('credit.tableName')\" prop=\"gift_name\">\n          <el-input v-model=\"giftForm.gift_name\"></el-input>\n        </el-form-item>\n        <el-form-item :label=\"$t('credit.tablePoint')\" prop=\"gift_point\">\n          <el-input v-model.number=\"giftForm.gift_point\"></el-input>\n        </el-form-item>\n        <el-form-item :label=\"$t('credit.tableAmount')\" prop=\"base_amount\">\n          <el-input v-model.number=\"giftForm.base_amount\"></el-input>\n        </el-form-item>\n        <el-form-item :label=\"$t('credit.tablePic')\">\n          <upload-img @logoUrl=\"getLogoUrl\" :logo=\"giftLogo\"></upload-img>\n        </el-form-item>\n      </el-form>\n\n      <span slot=\"footer\">\n        <el-button @click=\"giftFormVisible = false\">{{\n          $t(\"btn.cancel\")\n        }}</el-button>\n        <el-button\n          type=\"primary\"\n          @click=\"dialogStatus === 'create' ? createGift() : updateGift()\"\n          :loading=\"btnLoading.giftLoading\"\n          >{{ $t(\"btn.confirm\") }}</el-button\n        >\n      </span>\n    </el-dialog>\n  </el-card>\n</template>\n\n<script>\nimport { mapActions, mapMutations, mapState } from \"vuex\";\nimport UploadImg from \"../../components/UploadImg.vue\";\nexport default {\n  created() {\n    let giftObj = {\n      shop_id: this.shopId,\n      page: 1,\n      pageNum: 10,\n    };\n    this.getGiftList(giftObj).then((data) => {\n      this.giftTotalNum = data[0];\n    });\n    let couponObj = {\n      shop_id: this.shopId,\n      operate_mode: \"query\",\n      types: 1,\n      page: 1,\n      pageNum: 10,\n    };\n    this.getCouponList(couponObj).then((data) => {\n      this.couponTotalNum = data[0];\n    });\n    this.redeemPrice = this.basePricePoint;\n  },\n  components: {\n    UploadImg,\n  },\n  data() {\n    return {\n      redeemPrice: null,\n      giftForm: {\n        gift_name: null,\n        gift_point: null,\n        base_amount: null,\n        picture_url: null,\n      },\n\n      couponForm: {\n        money: undefined,\n        point: undefined,\n        amount: undefined,\n        valid_period: undefined,\n      },\n      dialogStatus: \"\",\n      couponFormVisible: false,\n      giftFormVisible: false,\n      tabActiveName: \"gift\",\n      btnLoading: {\n        couponLoading: false,\n        giftLoading: false,\n      },\n      redeemPointLoading: false,\n      giftTotalNum: 0,\n      couponTotalNum: 0,\n      giftLogo: \"\",\n    };\n  },\n  computed: {\n    textMap() {\n      return {\n        update: this.$t(\"credit.update\"),\n        create: this.$t(\"credit.create\"),\n      };\n    },\n    giftRules() {\n      return {\n        gift_name: [\n          {\n            required: true,\n            trigger: \"blur\",\n            message: this.$t(\"credit.nameMsg\"),\n          },\n        ],\n        gift_point: {\n          required: true,\n          trigger: \"blur\",\n          message: this.$t(\"credit.pointMsg\"),\n        },\n        base_amount: {\n          required: true,\n          trigger: \"blur\",\n          message: this.$t(\"credit.amountMsg\"),\n        },\n      };\n    },\n    couponRules() {\n      return {\n        money: {\n          required: true,\n          trigger: \"blur\",\n          message: this.$t(\"credit.moneyMsg\"),\n        },\n        point: {\n          required: true,\n          trigger: \"blur\",\n          message: this.$t(\"credit.pointMsg\"),\n        },\n        amount: {\n          required: true,\n          trigger: \"blur\",\n          message: this.$t(\"credit.amountMsg\"),\n        },\n        valid_period: {\n          required: true,\n          trigger: \"blur\",\n          message: this.$t(\"credit.validPeriodMsg\"),\n        },\n      };\n    },\n    ...mapState({\n      shopId: (state) => state.user.loginData.id,\n      giftList: (state) => state.member.giftList,\n      couponList: (state) => state.member.couponList,\n      basePricePoint: (state) => state.user.loginData.base_price_point,\n    }),\n  },\n  methods: {\n    getOnePageCoupon(page) {\n      let couponObj = {\n        shop_id: this.shopId,\n        operate_mode: \"query\",\n        types: 1,\n        page: page,\n        pageNum: 10,\n      };\n      this.getCouponList(couponObj);\n    },\n    getOnePageGift(page) {\n      let giftObj = {\n        shop_id: this.shopId,\n        page: page,\n        pageNum: 10,\n      };\n      this.getGiftList(giftObj);\n    },\n    giftCurrentChange(page) {\n      this.getOnePageGift(page);\n    },\n    giftPrevClick(page) {\n      this.getOnePageGift(page);\n    },\n    giftNextClick(page) {\n      this.getOnePageGift(page);\n    },\n    couponCurrentChange(page) {\n      this.getOnePageCoupon(page);\n    },\n    couponPrevClick(page) {\n      this.getOnePageCoupon(page);\n    },\n    couponNextClick(page) {\n      this.getOnePageCoupon(page);\n    },\n    addGift() {\n      this.giftFormVisible = true;\n      this.$refs.giftForm && this.$refs.giftForm.resetFields();\n      this.dialogStatus = \"create\";\n    },\n    addCoupon() {\n      this.couponFormVisible = true;\n      this.$refs.couponForm && this.$refs.couponForm.resetFields();\n      this.dialogStatus = \"create\";\n    },\n    createCoupon() {\n      this.$refs.couponForm.validate((valid) => {\n        if (valid) {\n          this.btnLoading.couponLoading = true;\n          let obj = {\n            types: 1,\n            operate_mode: \"insert\",\n            shop_id: this.shopId,\n            ...this.couponForm,\n            start_date: new Date(this.couponForm.start_date).getTime(),\n            end_date: new Date(this.couponForm.end_date).getTime(),\n          };\n          this.storeAddCoupon(obj).then(() => {\n            this.couponFormVisible = false;\n            this.btnLoading.couponLoading = false;\n            this.couponTotalNum += 1;\n            this.$refs.couponForm.resetFields();\n          });\n        }\n      });\n    },\n    giftEdit(scope) {\n      this.dialogStatus = \"update\";\n      this.giftFormVisible = true;\n      let { id, base_amount, gift_name, gift_point, picture_url } = scope.row;\n      console.log(scope.row);\n      this.giftForm = {\n        gift_name,\n        gift_point,\n        picture_url,\n        base_amount,\n        id,\n      };\n      this.giftLogo = this.giftForm.picture_url;\n    },\n    giftDelete(scope) {\n      this.storeDeleteGift(scope).then(() => {\n        this.giftTotalNum -= 1;\n      });\n    },\n    deleteCoupon(scope) {\n      this.storeDeleteCoupon(scope).then(() => {\n        this.couponTotalNum -= 1;\n      });\n    },\n    createGift() {\n      this.$refs.giftForm.validate((valid) => {\n        if (valid) {\n          this.btnLoading.giftLoading = true;\n          let obj = {\n            ...this.giftForm,\n            shop_id: this.shopId,\n          };\n          this.storeAddGift(obj)\n            .then(() => {\n              this.giftFormVisible = false;\n              this.btnLoading.giftLoading = false;\n              this.giftTotalNum += 1;\n              this.$refs.giftForm.resetFields();\n            })\n            .catch(() => {\n              this.btnLoading.giftLoading = false;\n              this.giftFormVisible = false;\n              this.$message.error(this.$t(\"error.serverErr\"));\n              this.$refs.giftForm.resetFields();\n            });\n        }\n      });\n    },\n    updateGift() {\n      this.$refs.giftForm.validate((valid) => {\n        if (valid) {\n          this.btnLoading.giftLoading = true;\n          this.storeEditGift(this.giftForm)\n            .then(() => {\n              this.giftFormVisible = false;\n              this.btnLoading.giftLoading = false;\n              this.$refs.giftForm.resetFields();\n            })\n            .catch(() => {\n              this.giftFormVisible = false;\n              this.btnLoading.giftLoading = false;\n              this.$message.error(this.$t(\"error.serverErr\"));\n              this.$refs.giftForm.resetFields();\n            });\n        }\n      });\n    },\n    handleTabClick(tab, event) {\n      console.log(tab, event);\n      console.log(this.couponList);\n    },\n    getLogoUrl(value) {\n      this.giftForm.picture_url = value;\n    },\n    addRedeemPoint() {\n      if (this.redeemPrice) {\n        if (this.redeemPrice != this.basePricePoint) {\n          this.redeemPointLoading = true;\n          this.alterShopInfo({\n            base_price_point: this.redeemPrice,\n          })\n            .then(() => {\n              this.redeemPointLoading = false;\n              this.$message({\n                message: this.$t(\"message.addSuc\"),\n                type: \"success\",\n              });\n            })\n            .catch(() => {\n              this.redeemPointLoading = false;\n            });\n        }\n      } else {\n        this.$message({\n          message: this.$t(\"message.fail\"),\n          type: \"error\",\n        });\n      }\n    },\n    ...mapActions({\n      storeAddCoupon: \"member/addCoupon\",\n      storeDeleteCoupon: \"member/deleteCoupon\",\n      storeDeleteGift: \"member/deleteShopGift\",\n      storeAddGift: \"member/addShopGift\",\n      getGiftList: \"member/getShopGift\",\n      getCouponList: \"member/getShopCoupon\",\n      storeEditGift: \"member/editShopGift\",\n      alterShopInfo: \"user/alterBusiness\",\n    }),\n    ...mapMutations({\n      commitCoupon: \"member/ADD_COUPON\",\n    }),\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n.credit_wrapper {\n  height: calc(100vh - 8em);\n  overflow-y: auto;\n}\n.credit_page_title {\n  color: $--color-primary;\n  text-align: center;\n  padding-bottom: 1em;\n}\n::v-deep .el-tabs__nav-wrap .el-tabs__nav-scroll .el-tabs__nav .el-tabs__item {\n  padding: 0 5em;\n}\n</style>\n","import { render, staticRenderFns } from \"./UploadImg.vue?vue&type=template&id=8dd532d8&scoped=true&\"\nimport script from \"./UploadImg.vue?vue&type=script&lang=js&\"\nexport * from \"./UploadImg.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UploadImg.vue?vue&type=style&index=0&id=8dd532d8&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8dd532d8\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-upload',{staticClass:\"avatar-uploader\",attrs:{\"action\":\"\",\"show-file-list\":false,\"http-request\":_vm.uploadFile}},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.avatarLoading),expression:\"avatarLoading\"}],staticClass:\"avatar_loading\"}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.avatarLoading),expression:\"!avatarLoading\"}],staticClass:\"avatar_wrapper\"},[_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm.imgUrl ? _vm.imgUrl : ''}}),_c('i',{staticClass:\"el-icon-plus avatar-uploader-icon\"}),_c('div',{staticClass:\"el-upload__tip\",attrs:{\"slot\":\"tip\"},slot:\"tip\"},[_vm._v(\" \"+_vm._s(_vm.$t(\"public.picInfo\"))+\" \")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=94ee31ea&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=94ee31ea&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"94ee31ea\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/sass-resources-loader/lib/loader.js??ref--8-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=94ee31ea&lang=scss&scoped=true&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/sass-resources-loader/lib/loader.js??ref--8-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UploadImg.vue?vue&type=style&index=0&id=8dd532d8&lang=scss&scoped=true&\"","import { Loading } from 'element-ui'\n\nlet loadingInstance\n\nexport function startLoading(targetdq) {\n    let options = {\n        text: 'loading......',\n        background: 'rgba(255, 255, 255, 0.6)',\n        target: document.querySelector(targetdq) || 'body',\n        customClass: 'server_loading'\n    }\n    loadingInstance = Loading.service(options)\n}\n\nexport function endLoading() {\n    loadingInstance.close()\n}\n\n"],"sourceRoot":""}