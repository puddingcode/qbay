{"version":3,"sources":["webpack:///./src/views/subAccount/addSubAccount/index.vue?f7bf","webpack:///./src/views/subAccount/addSubAccount/index.vue?810b","webpack:///./src/views/subAccount/addSubAccount/index.vue?8b3a","webpack:///src/views/subAccount/addSubAccount/index.vue","webpack:///./src/views/subAccount/addSubAccount/index.vue"],"names":["mounted","this","$route","params","username","subAccount","data","password","oldName","isLoading","methods","complete","$refs","form","validate","valid","modifySubAccount","alterSub","addSubAccount","registerSubAccount","computed","editNameRule","normalRules","addingRules","component","_vm","_h","$createElement","_c","_self","staticClass","_v","_s","$t","ref","attrs","model","value","callback","$$v","$set","expression","on"],"mappings":"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","file":"js/chunk-88add2de.6ed7f64f.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/sass-resources-loader/lib/loader.js??ref--8-oneOf-1-4!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=61b3b9d2&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"subaccount_wrapper\"},[_c('div',{staticClass:\"subaccount_content\"},[_c('div',{staticClass:\"subaccount_title\"},[_vm._v(_vm._s(_vm.$t(\"subAccount.title\")))]),_c('el-form',{ref:\"form\",attrs:{\"rules\":_vm.addingRules,\"model\":_vm.subAccount}},[_c('el-form-item',{attrs:{\"prop\":\"username\"}},[_c('el-input',{attrs:{\"placeholder\":_vm.$t('subAccount.namePlaceholder')},model:{value:(_vm.subAccount.username),callback:function ($$v) {_vm.$set(_vm.subAccount, \"username\", $$v)},expression:\"subAccount.username\"}})],1),_c('el-form-item',{attrs:{\"prop\":\"password\"}},[_c('el-input',{attrs:{\"placeholder\":_vm.$t('subAccount.passwordPlaceholder')},model:{value:(_vm.subAccount.password),callback:function ($$v) {_vm.$set(_vm.subAccount, \"password\", $$v)},expression:\"subAccount.password\"}})],1),_c('el-form-item',{staticClass:\"btn_wrapper\"},[_c('el-button',{staticClass:\"subaccount_btn\",attrs:{\"type\":\"primary\",\"loading\":_vm.isLoading},on:{\"click\":_vm.complete}},[_vm._v(_vm._s(_vm.$t(\"btn.complete\")))])],1)],1)],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","<template>\n  <div class=\"subaccount_wrapper\">\n    <div class=\"subaccount_content\">\n      <div class=\"subaccount_title\">{{ $t(\"subAccount.title\") }}</div>\n      <el-form ref=\"form\" :rules=\"addingRules\" :model=\"subAccount\">\n        <el-form-item prop=\"username\">\n          <el-input\n            v-model=\"subAccount.username\"\n            :placeholder=\"$t('subAccount.namePlaceholder')\"\n          ></el-input>\n        </el-form-item>\n        <el-form-item prop=\"password\">\n          <el-input\n            v-model=\"subAccount.password\"\n            :placeholder=\"$t('subAccount.passwordPlaceholder')\"\n          ></el-input>\n        </el-form-item>\n        <el-form-item class=\"btn_wrapper\">\n          <el-button\n            class=\"subaccount_btn\"\n            type=\"primary\"\n            :loading=\"isLoading\"\n            @click=\"complete\"\n            >{{ $t(\"btn.complete\") }}</el-button\n          >\n        </el-form-item>\n      </el-form>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapActions, mapState } from \"vuex\";\nexport default {\n  mounted() {\n    if (this.$route.params.username) {\n      this.subAccount = this.$route.params;\n    }\n  },\n  data() {\n    return {\n      subAccount: {\n        username: \"\",\n        password: \"\",\n      },\n      oldName: this.$route.params.username,\n      isLoading: false,\n    };\n  },\n  methods: {\n    complete() {\n      this.$refs.form.validate((valid) => {\n        if (valid) {\n          this.isLoading = true;\n          if (this.$route.params.username) {\n            // 走修改逻辑\n            this.modifySubAccount();\n          } else {\n            this.addSubAccount();\n          }\n        }\n      });\n    },\n    modifySubAccount() {\n      this.alterSub({\n        username: this.oldName,\n        subAccount: this.subAccount,\n      })\n        .then(() => {\n          this.isLoading = false;\n          // this.subAccount.username = \"\";\n          // this.subAccount.password = \"\";\n          this.$refs.form.resetFields();\n          this.$alert(this.$t(\"public.modifySuccessMsg\"), \"\", {\n            confirmButtonText: this.$t(\"btn.confirm\"),\n            center: true,\n          }).then(() => {\n            this.$router.go(-1);\n          });\n        })\n        .catch((err) => {\n          if (err) {\n            this.isLoading = false;\n            this.$refs.form.resetFields();\n            this.$message.error(this.$t(\"error.serverErr\"));\n          }\n        });\n    },\n    addSubAccount() {\n      this.registerSubAccount(this.subAccount)\n        .then(() => {\n          this.isLoading = false;\n          this.$refs.form.resetFields();\n          this.$alert(this.$t(\"public.addSuccessMsg\"), \"\", {\n            confirmButtonText: this.$t(\"btn.confirm\"),\n            center: true,\n          }).then(() => {\n            this.$router.push({ path: \"/subaccount/index/listofsubaccounts\" });\n          });\n        })\n        .catch((err) => {\n          if (err) {\n            this.isLoading = false;\n            this.$refs.form.resetFields();\n            this.$message.error(this.$t(\"error.serverErr\"));\n          }\n        });\n    },\n    ...mapActions({\n      registerSubAccount: \"user/registerSubAccount\",\n      alterSub: \"user/alterSubAccount\",\n    }),\n  },\n  computed: {\n    editNameRule() {\n      return {\n        username: [\n          {\n            validator: (rule, value, callback) => {\n              if (\n                this.subAccountList.filter((item) => item.username === value)\n                  .length\n              ) {\n                callback(new Error(this.$t(\"error.sameNameErr\")));\n              } else {\n                callback();\n              }\n            },\n            trigger: \"blur\",\n          },\n          {\n            required: true,\n            message: this.$t(\"subAccount.nameRequiredErrMsg\"),\n            trigger: \"blur\",\n          },\n          {\n            validator: (rule, value, callback) => {\n              let reg = /^[a-zA-Z0-9]{6,12}$/;\n              if (value) {\n                if (!reg.test(value)) {\n                  callback(new Error(this.$t(\"subAccount.nameLengthErrMsg\")));\n                } else {\n                  callback();\n                }\n              } else {\n                callback();\n              }\n            },\n          },\n        ],\n      };\n    },\n    normalRules() {\n      return {\n        username: [\n          {\n            required: true,\n            message: this.$t(\"subAccount.nameRequiredErrMsg\"),\n            trigger: \"blur\",\n          },\n          {\n            validator: (rule, value, callback) => {\n              let reg = /^[a-zA-Z0-9]{6,12}$/;\n              if (value) {\n                if (!reg.test(value)) {\n                  callback(new Error(this.$t(\"subAccount.nameLengthErrMsg\")));\n                } else {\n                  callback();\n                }\n              } else {\n                callback();\n              }\n            },\n          },\n        ],\n        password: [\n          {\n            required: true,\n            message: this.$t(\"subAccount.passwordRequiredErrMsg\"),\n            trigger: \"blur\",\n          },\n          {\n            min: 8,\n            max: 16,\n            message: this.$t(\"subAccount.passwordLengthErrMsg\"),\n          },\n          {\n            validator: (rule, value, callback) => {\n              let reg = /^(?![\\d]+$)(?![a-zA-Z]+$)(?![^\\da-zA-Z]+$).{8,16}$/;\n              if (value) {\n                if (!reg.test(value)) {\n                  callback(new Error(this.$t(\"subAccount.passwordTypeErrMsg\")));\n                } else {\n                  callback();\n                }\n              } else {\n                callback();\n              }\n            },\n          },\n        ],\n      };\n    },\n    addingRules() {\n      if (this.$route.params.username) {\n        return this.normalRules;\n      } else {\n        return { ...this.normalRules, ...this.editNameRule };\n      }\n    },\n    ...mapState({\n      userinfo: (state) => state.user.loginData,\n      subAccountList: (state) => state.user.subAccount,\n    }),\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.subaccount_wrapper {\n  text-align: center;\n  height: calc(100vh - 230px);\n  .subaccount_content {\n    position: relative;\n    padding: 5em 8em 0;\n    box-sizing: border-box;\n    height: 100%;\n    overflow-y: auto;\n  }\n}\n\n.subaccount_title {\n  text-align: left;\n  color: $--color-primary;\n  padding-bottom: 3em;\n}\n\n.btn_wrapper {\n  position: absolute;\n  bottom: 0;\n  margin-left: calc(50% - 128px - 10em);\n}\n\n.subaccount_btn {\n  width: 20em;\n}\n@media screen and (max-height: 640px) {\n  .btn_wrapper {\n    position: static;\n    margin-top: 4em;\n  }\n}\n</style>\n","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=61b3b9d2&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=61b3b9d2&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"61b3b9d2\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}